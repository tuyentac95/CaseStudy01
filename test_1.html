<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test</title>
    <style>
        body {
            background-image: url("Background_undersea_02.jpg");
        }
    </style>
</head>
<body onload="docReady()">
<canvas id="myCanvas" width="1300" height="600" style="border: 1px solid #c3c3c3"></canvas>
<img id="character" src="Gyarados_left_move.gif" style="position: absolute; left: 0; top: 0;border: 0px solid black"/>
<script>
    let canvas = document.getElementById('myCanvas');
    let ctx = canvas.getContext('2d');
    let character = document.getElementById('character');
    let bullet = new Image();
    let razz = new Image();
    razz.src = 'Berry_Razz.png'
    let Berry = function (image) {
        this.x = 500;
        this.y = 300;
        this.image = image;
        this.appear = function () {
            ctx.drawImage(this.image, this.x, this.y, 50, 50);
        }
        this.disappear = function () {
            if (this.isEaten()) {
                ctx.clearRect(this.x, this.y, 50, 50);
            } else this.appear();
        }
        this.isEaten = function () {
            if (((parseInt(character.style.left) + 110 <= this.x) && (parseInt(character.style.left) + 150 >= this.x))
                && ((parseInt(character.style.top) + 75 <= this.y) && (parseInt(character.style.top) + 115 >= this.y)))
            {
                return true
            } else return false;
        }
    }
    let berryRazz = new Berry(razz);
    berryRazz.appear();

    console.log(berryRazz.image.src)
    function upArrowPressed() {
        if (parseInt(character.style.top) >= 0) {
            character.style.top = parseInt(character.style.top) - 20 + 'px';
        }
    }

    function downArrowPressed() {
        if (parseInt(character.style.top) < canvas.height - character.width)
        character.style.top = parseInt(character.style.top) + 20 + 'px';
    }

    function leftArrowPressed() {
        if (character.src.match('right')) {
            character.src = 'Gyarados_left_move.gif';
        }
        if (parseInt(character.style.left) >= 0)
        character.style.left = parseInt(character.style.left) - 20 + 'px';
    }

    function rightArrowPressed() {
        if (character.src.match('left')) {
            character.src = 'Gyarados_right_move.gif';
        }
        if (parseInt(character.style.left) < canvas.width - character.width)
        character.style.left = parseInt(character.style.left) + 20 + 'px';
    }

    function aPressed() {
        if (character.src.match('left')) {
            character.src = 'Gyarados_left_roar.gif';
            bullet.src="Energy_ball_1_left.png";
            let x = parseInt(character.style.left) - 50;
            let y = parseInt(character.style.top) + 95;
            setTimeout(function () {
                ctx.drawImage(bullet, x, y, 84, 58);
                setInterval(function () {
                    ctx.clearRect(x, y, 84, 58);
                    x -= 30;
                    if (x > 0) {
                        ctx.drawImage(bullet, x, y, 84, 58);
                    }
                },50)
            },680)
            setTimeout(function () {
                character.src = 'Gyarados_left_move.gif';
            },1500);
        } else {
            character.src = 'Gyarados_right_roar.gif';
            bullet.src="Energy_ball_1_right.png";
            let x = parseInt(character.style.left) + 140;
            let y = parseInt(character.style.top) + 95;
            setTimeout(function () {
                ctx.drawImage(bullet, x, y, 84, 58);
                setInterval(function () {
                    ctx.clearRect(x, y, 84, 58);
                    berryRazz.disappear();
                    x += 30;
                    if (x < canvas.width) {
                        ctx.drawImage(bullet, x, y, 84, 58);
                    }
                },50)
            },680)
            setTimeout(function () {
                character.src = 'Gyarados_right_move.gif';
            },1500);
        }
    }

    function sPressed() {
        if (character.src.match('left')) {
            character.src = 'Gyarados_left_bite.gif';
            setTimeout(function () {
                character.src = 'Gyarados_left_move.gif';
            },1500);
        } else {
            character.src = 'Gyarados_right_bite.gif';
            setTimeout(function () {
                console.log(berryRazz.isEaten());
                berryRazz.disappear();
            }, 700);
            setTimeout(function () {
                character.src = 'Gyarados_right_move.gif';
            },1500);
        }
    }

    function moveSelection(evt) {
        switch (evt.keyCode) {
            case 37:
                leftArrowPressed();
                break;
            case 38:
                upArrowPressed();
                break;
            case 39:
                rightArrowPressed();
                break;
            case 40:
                downArrowPressed();
                break;
            case 65:
                aPressed();
                break;
            case 83:
                sPressed();
                break;
        }
    }
    function docReady() {
        window.addEventListener('keydown', moveSelection);
    }
</script>
</body>
</html>